define("saber-ajax/requester/Kernel",["require","../const","../util"],function(require){function e(e){var t;if(e.responseType&&e.responseType!==o.TEXT)t=e.response;else t=e.responseText;return t}function t(e){i.each(s,function(t){e["on"+t]=null})}function n(e,t){var n=new XMLHttpRequest;n.open(e.method,e.url,e.async||!0,e.username,e.password);var a=window.FormData?e.data instanceof FormData:!1,u=e.headers;if(e.method===r.POST&&!i.findHeader(u,"Content-Type")&&!a)u["Content-Type"]="application/x-www-form-urlencoded";i.each(u,function(e,t){n.setRequestHeader(e,t)});var c;if(c=e.responseType)n.responseType=o[c.toUpperCase()]||o.TEXT;if(e.async!==!1&&e.timeout)n.timeout=e.timeout;if(e.progress)if("function"==typeof e.progress)n.onprogress=e.progress;else if(e.progress.upload&&n.upload)n.upload.onprogress=e.progress.upload;else if(e.progress.download)n.onprogress=e.progress.download;i.each(s,function(e,r){n["on"+e]=r(n,t)});var l=e.data;if(a)n.send(l);else if(!i.isString(l)&&e.stringify!==!1)n.send(i.stringify(l));else n.send(l);return n}var r=require("../const").METHOD,i=require("../util"),o={TEXT:"text",ARRAYBUFFER:"arraybuffer",DOCUMENT:"document",BLOB:"blob",JSON:"json"},s={load:function(n,r){return function(){t(n),r.handle(null,n,e(n))}},error:function(e,n){return function(){t(e),n.handle("error")}},abort:function(e,n){return function(){t(e),n.handle("abort")}},timeout:function(e,n){return function(){t(e),n.handle("timeout")}}};return n});