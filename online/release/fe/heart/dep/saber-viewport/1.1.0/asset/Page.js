define("saber-viewport/Page",["require","saber-dom","saber-promise","saber-emitter"],function(require){function e(e){if(e.main&&e.main.parentNode)e.main.parentNode.removeChild(e.main);e.main=null,e.viewport=null}function t(e,t,n){n=n||{},i.mixin(this),this.data=n.data||{},this.url=e,this.viewport=t,this.cached=n.cached,this.hasVisited=!!n.hasVisited,this.main=n.main||document.createElement("div")}var n=require("saber-dom"),r=require("saber-promise"),i=require("saber-emitter"),o="data-viewport",s=o+"-bar",a=o+"-fixed";return t.prototype.getBar=function(){var e=this.main,t=n.queryAll("["+s+"]",e),r={};return t.forEach(function(e){r[e.getAttribute(s)]=e}),r},t.prototype.getFixed=function(){var e=this.main;return n.queryAll("["+a+"]",e)},t.prototype.clone=function(e){var n=new t(this.url,this.viewport,{cached:e.cached,main:this.main,data:this.data,hasVisited:this.hasVisited});return n},t.prototype.enter=function(e,t){if(!this.main)return r.rejected();else return this.viewport.transition(this,e,t)},t.prototype.remove=function(t){if(!this.cached||t===!0)e(this);else if(this.main&&this.main.parentNode)this.main.parentNode.removeChild(this.main)},t});