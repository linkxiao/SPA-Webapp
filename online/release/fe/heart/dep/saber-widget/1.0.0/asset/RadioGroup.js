define("saber-widget/RadioGroup",["require","saber-lang","saber-dom","saber-string/format","./Widget","./main"],function(require){function e(e){this.attrs={datasource:{value:[],repaint:!0},value:{value:null,setter:this.syncValue}},o.call(this,e)}function t(e,t){return"[data-"+e+(t?'="'+t+'"':"")+"]"}var n=require("saber-lang"),r=require("saber-dom"),i=require("saber-string/format"),o=require("./Widget"),a='<div data-role="radio" data-value="${value}"${checked}>${name}</div>',s=t("role","radio");return e.prototype.type="RadioGroup",e.prototype.initOptions=function(e){if(o.prototype.initOptions.call(this,e),!this.get("datasource").length&&!this.get("value"))this.addState("prerender"),this.extractData()},e.prototype.initEvent=function(){this.addEvent(this.get("main"),"click",this.clickHandler),this.on("propertychange",this.propertyChangeHandler)},e.prototype.propertyChangeHandler=function(e,t,n,r){if("value"===t)this.emit("valuechange",n,r)},e.prototype.syncValue=function(e){if(!this.is("prerender")){var t=this.getItemByValue(e),n=this.get("value"),i=this.getItemByValue(n);if(e!==n){if(i)r.removeData(i,"checked");if(t)r.setData(t,"checked",!0)}}},e.prototype.getItemByValue=function(e){if(!e)return null;else return r.query(t("value",e),this.get("main"))},e.prototype.clickHandler=function(e){var t=r.closest(e.target,s,this.get("main"));if(t){var n=this.get("value"),i=r.getData(t,"value");this.set("value",i),this.emit("click",n,i)}},e.prototype.extractData=function(){var e=r.queryAll(s,this.get("main")),t=[],n=null;e.forEach(function(e){var i=r.getData(e,"value");if(t.push({value:i,name:e.innerHTML}),null!==e.getAttribute("data-checked"))n=i}),this.set("datasource",t),this.set("value",n)},e.prototype.getHtml=function(){var e=this.get("datasource")||[],t=[],n=this;return e.forEach(function(e){t.push(n.getItemHtml(e))}),t.join("")},e.prototype.getItemHtml=function(e){var t=this.get("value");if(e.value===t)e.checked=" data-checked";return i(a,e)},e.prototype.repaint=function(){if(this.is("prerender"))return void this.removeState("prerender");var e=this.get("value");this.get("main").innerHTML=this.getHtml(),this.set("value",e)},n.inherits(e,o),require("./main").register(e),e});