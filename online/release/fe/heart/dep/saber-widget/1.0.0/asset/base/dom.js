define("saber-widget/base/dom",["require","saber-lang/bind","saber-lang/function/debounce","../main"],function(require){function e(e,t,n){var i=e.domEvents[t[s]][n.type];if(i)i.forEach(function(e){e.call(this,n)},e)}function t(t,i){var r=n(t);r=r?r[i.type]:[],r.forEach(function(n){e(n,t,i)})}function n(e){if(window===e)return a.win;if(document===e)return a.doc;if(document.documentElement===e)return a.root;if(document.body===e)return a.body;else return null}var i=require("saber-lang/bind"),r=require("saber-lang/function/debounce"),o=require("../main"),s="_uiDOMEvent",a={win:{},doc:{},root:{},body:{}},exports={};return exports.addEvent=function(a,u,c){if(!this.domEvents)this.domEvents={};var l=a[s];if(!l)l=a[s]=o.getGUID();var f=this.domEvents[l];if(!f)f=this.domEvents[l]={node:a};var h=n(a);if(h){var p=h[u];if(!p){if(p=h[u]=[],p.handler=i(t,null,a),"resize"===u||"scroll"===u)p.handler=r(p.handler,150);a.addEventListener(u,p.handler,!1)}if(p.indexOf(this)<0)p.push(this)}var d=f[u];if(!d)if(d=f[u]=[],!h)d.handler=i(e,null,this,a),a.addEventListener(u,d.handler,!1);if(d.indexOf(c)<0)d.push(c)},exports.removeEvent=function(e,t,i){var r=this.domEvents;if(r)if(r=r[e[s]],r&&r[t]){var o,a=r[t];if(i){if(o=a.indexOf(i),o>=0)a.splice(o,1)}else a.length=0;var u=n(e);if(!a.length){if(a.handler)e.removeEventListener(t,a.handler,!1);if(a.length=0,delete r[t],"node"===Object.keys(r).join(""))r=null,delete this.domEvents[e[s]];if(u&&u[t])if(o=u[t].indexOf(this),o>=0)u[t].splice(o,1)}if(u)if(a=u[t],a&&!a.length)e.removeEventListener(t,a.handler,!1),a.length=0,delete u[t];a=null}},exports.clearEvents=function(e){var t=this.domEvents;if(t){var n;if(!e){for(n in t)if(t.hasOwnProperty(n))this.clearEvents(t[n].node);return void(this.domEvents=null)}if(n=e[s],t=t[n]){delete t.node;for(var i in t)if(t.hasOwnProperty(i))this.removeEvent(e,i)}if(n)delete this.domEvents[n]}},exports});