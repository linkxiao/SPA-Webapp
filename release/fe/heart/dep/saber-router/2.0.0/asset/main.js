define("saber-router/main",["require","saber-lang/extend","./config","./controller"],function(require){function e(e){var t=-1;return e=e.toString(),c.some(function(n,r){if(n.raw.toString()===e)t=r;return-1!==t}),t}function t(e,t){for(var n,r={},i=t.params||[],o=e.match(t.path)||[],s=1;s<o.length;s++)n=i[s-1]||"$"+s,r[n]=decodeURIComponent(o[s]);return r}function n(e,r){function i(){if(l=!1,o){var e=s({},o);o=null,n(e.url,e.options)}}if(r=r||{},l)return void(o={url:e,options:r});l=!0;var a,u,f=s({},e.getQuery()),p={},h=e.getPath();if(c.some(function(n){if(n.path instanceof RegExp){if(n.path.test(h))a=n,p=t(h,n)}else if(e.equalPath(n.path))a=n;if(!n.path)u=n;return!!a}),a=a||u,!a)throw o=null,l=!1,new Error("can not found route for: "+h);if(r.title)document.title=r.title;var d=[h,f,p,e.toString(),r];if(a.fn.length>d.length)d.push(i),a.fn.apply(a.thisArg,d);else a.fn.apply(a.thisArg,d),i()}function r(e){var t={params:[]};return t.path=e.replace(/:([^/]+)/g,function(e,n){return t.params.push(n),"([^/]+)"}),t.path=new RegExp(t.path+"$"),t}function i(e,t,n){var i={raw:e,path:e,fn:t,thisArg:n};if(!(e instanceof RegExp)&&e.indexOf(":")>=0)i=s(i,r(e));c.push(i)}var o,s=require("saber-lang/extend"),a=require("./config"),u=require("./controller"),c=[],l=!1,exports={};return exports.reset=function(e,t,n){u.reset(e,t,n)},exports.config=function(e){e=e||{};var t=e.root;if(t&&"/"===t.charAt(t.length-1))t=e.root=t.substring(0,t.length-1);if(t&&"/"!==t.charAt(0))e.root="/"+t;s(a,e)},exports.add=function(t,n,r){if(e(t)>=0)throw new Error("path has been existed");i(t,n,r)},exports.remove=function(t){var n=e(t);if(n>=0)c.splice(n,1)},exports.clear=function(){c=[]},exports.redirect=function(e,t,n){u.redirect(e,t,n)},exports.start=function(e){exports.config(e),u.init(n)},exports.stop=function(){u.dispose(),exports.clear(),o=null},exports.controller=function(e){u.plugin(e)},exports}),define("saber-router",["saber-router/main"],function(e){return e});