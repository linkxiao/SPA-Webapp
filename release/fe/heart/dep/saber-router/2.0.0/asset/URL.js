define("saber-router/URL",["require","saber-uri/component/Path","saber-uri/component/Query","saber-uri/component/Fragment","./config"],function(require){function e(e){if("/"===e.charAt(e.length-1))e+=o.index;return e}function t(e,t){t=t||{},e=(e||"").trim()||o.path;var a=this.token=t.token||s,u=t.root||o.root;if("/"===u.charAt(u.length-1))u=u.substring(0,u.length-1);this.root=u,e=e.split("#"),this.fragment=new i(e[1]),e=e[0].split(a);var c=t.base||{};this.path=new r(e[0],c.path),this.query=new n(e[1]);var l=this.path.get();if(this.outRoot=0===l.indexOf(".."),this.outRoot)if(l=r.resolve(u+"/",l),0===l.indexOf(u))l=l.substring(u.length),this.path.set(l),this.outRoot=!1;if(!this.outRoot&&"/"!==l.charAt(0))this.path.set("/"+l);if(t.query)this.query.add(t.query)}var r=require("saber-uri/component/Path"),n=require("saber-uri/component/Query"),i=require("saber-uri/component/Fragment"),o=require("./config"),s="?";return t.prototype.toString=function(){var e=this.root,t=this.path.get();if(this.outRoot)t=r.resolve(e+"/",t);else t=e+t;return t+this.query.toString(this.token)+this.fragment.toString()},t.prototype.equalPath=function(t){var r=e(this.path.get());return t=e(t),r===t},t.prototype.equal=function(e){return this.query.equal(e.query)&&this.equalPath(e.path.get())},t.prototype.equalWithFragment=function(e){return this.equal(e)&&this.fragment.equal(e.fragment)},t.prototype.getQuery=function(){return this.query.get()},t.prototype.getPath=function(){return this.path.get()},t});