define([],function(){function e(e){return"function"==typeof e}function t(e){return"[object Object]"===Object.prototype.toString.call(e)}function r(n,i){function o(e){if(!u)r(n,e),u=!0}function s(e){if(!u)n.reject(e),u=!0}function a(){var r;if(t(i)||e(i))if(r=i.then,e(r))r.call(i,o,s);else r=null;if(!r)n.fulfill(i)}var u;if(p)try{a()}catch(l){if(!u)c(l),n.reject(l)}else a()}function n(e,t,n){return function(i){function o(){var o=n(i);if(o===t)throw new TypeError;r(e,o)}if(p)try{o()}catch(s){c(s),e.reject(s)}else o()}}function i(e,t,r){if(e.status===t)d(function(){r(e.data)});else if(t===f.FULFILLED)e.fulfillList.push(r);else if(t===f.REJECTED)e.rejectList.push(r)}function o(e){var t=e.status===f.FULFILLED?e.fulfillList:e.rejectList;if(u(e),t.length)d(function(){for(var r;r=t.shift();)r(e.data)})}function s(t,r,o){var s=new l,u=a(s);if(e(r))r=n(s,u,r);else r=function(e){s.fulfill(e)};if(i(t,f.FULFILLED,r),e(o))o=n(s,u,o);else o=function(e){s.reject(e)};return i(t,f.REJECTED,o),u}function a(e){return{then:function(t,r){return s(e,t,r)}}}function u(e){var t=e.status===f.FULFILLED?"resolve":"reject";if(h)l.emit(t,e.data)}function c(e){if(h)l.emit("exception",e)}function l(){this.status=f.PENDING,this.fulfillList=[],this.rejectList=[]}var f={PENDING:0,FULFILLED:1,REJECTED:2},p=!0,h=!1,d=function(){function t(){var e,t=i.length;for(e=0;t>e;e++)i[e]();i.splice(0,e)}var r,n,i=[],o="promise";if("function"==typeof setImmediate)r=setImmediate;else if(n=window.MutationObserver||window.webKitMutationObserver){var s=new n(function(e){var r=e[0];if(r.attributeName===o)t()}),a=document.createElement("div");s.observe(a,{attributes:!0}),r=function(e){i.push(e),a.setAttribute(o,Date.now?Date.now():(new Date).getTime())}}else if(e(window.postMessage))window.addEventListener("message",function(e){if(e.source===window&&e.data===o)t()},!1),r=function(e){i.push(e),window.postMessage(o,"*")};else r=function(e){setTimeout(e,0)};return r}();return l.enableGlobalEvent=function(e){e.mixin(this),h=!0},l.disableExceptionCapture=function(){p=!1},l.enableExceptionCapture=function(){p=!0},l.all=function(e){function t(t){return function(r){if(o[t]=r,i++,i>=e.length)n.fulfill(o)}}function r(e){n.reject(e)}if(!Array.isArray(e))e=Array.prototype.slice.call(arguments);var n=new l,i=0,o=[];return e.forEach(function(e,n){e.then(t(n),r)}),n.promise()},l.promise=function(e){var t=new l;return e(t),t.promise()},l.rejected=function(e){return this.promise(function(t){t.reject(e)})},l.fulfilled=function(e){return this.promise(function(t){t.fulfill(e)})},l.resolved=l.fulfilled,l.prototype.fulfill=function(e){if(this.status===f.PENDING)this.data=e,this.status=f.FULFILLED,o(this)},l.prototype.resolve=l.prototype.fulfill,l.prototype.reject=function(e){if(this.status===f.PENDING)this.data=e,this.status=f.REJECTED,o(this)},l.prototype.promise=function(){return a(this)},l});