define("plugin/slide/1.0/slide-img",["require"],function(){function e(e){this.wrap=e.wrap,this.wrapWidth=this.wrap.offsetWidth,this.wrapInner=this.wrap.getElementsByTagName("ul")[0],this.lists=this.wrap.getElementsByTagName("li"),this.listLength=this.lists.length;var t={loop:!1,autoPlay:!1,autoTime:5e3,speed:300,pagination:!0};this.ops=e||{};for(var n in t)if("undefined"==typeof e[n])e[n]=t[n];else if("object"==typeof e[n])for(var i in t[n])if("undefined"==typeof e[n][j])e[n][j]=t[n][j];this.init(),this.bindEvent()}function t(t){return new e(t)}return e.prototype.createSprite=function(){var e=document.createElement("div");e.className="spinner";for(var t=0;3>t;t++){var n=document.createElement("div");n.className="bounce"+parseInt(t+1),e.appendChild(n)}this.wrap.appendChild(e);var i=new Image;i.src=this.lists[this.listLength-1].getElementsByTagName("img")[0].src;var r=this;i.onload=function(){e.remove(),r.wrapInner.style.opacity="1"}},e.prototype.init=function(){this.ratio=this.wrap.offsetHeight/this.wrap.offsetWidth,this.wrapWidth=this.wrap.offsetWidth,this.wrapHeight=this.wrap.offsetHeight,this.wrapInner.style.width=this.wrapWidth+"px",this.index=0;for(var e=0;e<this.listLength;e++){this.lists[e].style.width=this.wrapWidth+"px",this.lists[e].style.webkitTransform="translate3d("+e*this.wrapWidth+"px,0,0)";var t=this.lists[e].getElementsByTagName("img")[0];if(t.height/t.width>this.ratio)t.style.height=this.wrapHeight+"px";else t.style.width=this.wrapWidth+"px";delete t}if(this.ops.pagination)this.createBullet();if(this.ops.loop)this.copyLists(),this.index=1,this.listLength=this.wrapInner.getElementsByTagName("li").length;if(this.ops.autoPlay)this.autoPlay();var n=this,i=null;window.onresize=function(){if(i)clearTimeout(i);i=setTimeout(function(){n.resizeInit()},300)}},e.prototype.resizeInit=function(){this.ratio=this.wrap.offsetHeight/this.wrap.offsetWidth,this.wrapWidth=this.wrap.offsetWidth,this.wrapHeight=this.wrap.offsetHeight,this.wrapInner.style.width=this.wrapWidth+"px";for(var e=0;e<this.listLength;e++){if(this.lists[e].style.width=this.wrapWidth+"px",this.index>e)this.Transform3d(this.lists[e],-this.wrapWidth,!1);else if(this.index<e)this.Transform3d(this.lists[e],this.wrapWidth,!1);var t=this.lists[e].getElementsByTagName("img")[0];if(t.height/t.width>this.ratio)t.style.height=this.wrapHeight+"px",t.style.width="auto";else t.style.width=this.wrapWidth+"px",t.style.height="auto";delete t}},e.prototype.copyLists=function(){var e=document.createElement("li"),t=document.createElement("li");e.style.cssText=this.wrapWidth+"px",e.style.webkitTransform="translate3d(-"+this.wrapWidth+"px,0,0)",e.innerHTML=this.lists[this.listLength-1].innerHTML,t.style.cssText=this.wrapWidth+"px",t.style.webkitTransform="translate3d("+this.listLength*this.wrapWidth+"px,0,0)",t.innerHTML=this.lists[0].innerHTML,this.wrapInner.insertBefore(e,this.wrapInner.firstChild),this.wrapInner.appendChild(t)},e.prototype.createBullet=function(){var e=this;pagination=document.createElement("div"),pagination.className="pagination";for(var t=0;t<this.listLength;t++){if(span=document.createElement("span"),this.index==t)span.className="active";span.addEventListener("click",function(t){e.moveTo(t)}.bind(null,t)),pagination.appendChild(span)}this.wrap.appendChild(pagination),this.bulletLists=pagination.getElementsByTagName("span"),this.bllength=this.bulletLists.length},e.prototype.autoPlay=function(){var e=this;clearInterval(e.timer),e.timer=setInterval(function(){e.move("+1")},e.ops.autoTime)},e.prototype.stopPlay=function(){clearInterval(this.timer)},e.prototype.Transform3d=function(e,t,n){if(!e)throw new Error("未指定动画元素！");else e.style.webkitTransform="translate3d("+t+"px,0,0)";if(n)e.style.webkitTransition=this.ops.speed+"ms ease-out";else e.style.webkitTransition="none"},e.prototype.loopSetting=function(e){var t=this;switch(e){case 0:setTimeout(function(){mindex=t.listLength-2,t.index=mindex,t.Transform3d(t.lists[0],-t.wrapWidth,!1),t.Transform3d(t.lists[mindex],0,!1),t.Transform3d(t.lists[mindex+1],t.wrapWidth,!1),t.Transform3d(t.lists[mindex-1],-t.wrapWidth,!1);for(var e=mindex-1;e>0;e--)t.Transform3d(t.lists[e],-t.wrapWidth,!1)},t.ops.speed);break;case t.listLength-1:setTimeout(function(){mindex=1,t.index=mindex,t.Transform3d(t.lists[mindex],0,!1),t.Transform3d(t.lists[mindex+1],t.wrapWidth,!1),t.Transform3d(t.lists[mindex-1],-t.wrapWidth,!1),t.Transform3d(t.lists[t.listLength-1],t.wrapWidth,!1);for(var e=mindex+1;e<t.listLength-1;e++)t.Transform3d(t.lists[e],t.wrapWidth,!1)},t.ops.speed)}},e.prototype.moveTo=function(e){this.stopPlay();var t=e+1;if(this.ops.pagination){for(var n=0;n<this.bllength;n++)this.bulletLists[n].setAttribute("class","");this.bulletLists[e].setAttribute("class","active")}if(this.index=t,this.lists[t]&&this.Transform3d(this.lists[t],0,!0),this.lists[t+1]&&this.Transform3d(this.lists[t+1],this.wrapWidth,!0),this.lists[t-1]&&this.Transform3d(this.lists[t-1],-this.wrapWidth,!0),this.ops.loop)this.loopSetting(this.index);this.autoPlay()},e.prototype.move=function(e){var t;if("number"==typeof e)t=this.index;else if("string"==typeof e)t=this.index+1*e;if(t>this.listLength-1)t=this.listLength-1;else if(0>t)t=0;if(this.ops.pagination)for(var n=0;n<this.bllength;n++)if(n==t-1)this.bulletLists[n].setAttribute("class","active");else if(this.bulletLists[n].setAttribute("class",""),t>this.bllength)this.bulletLists[0].setAttribute("class","active");else if(0==t)this.bulletLists[this.bllength-1].setAttribute("class","active");if(this.index=t,this.lists[t]&&this.Transform3d(this.lists[t],0,!0),this.lists[t+1]&&this.Transform3d(this.lists[t+1],this.wrapWidth,!0),this.lists[t-1]&&this.Transform3d(this.lists[t-1],-this.wrapWidth,!0),this.ops.loop)this.loopSetting(this.index)},e.prototype.bindEvent=function(){var e=this,t=this.wrapWidth/3,n=function(t){e.startX=t.touches[0].pageX,e.offsetX=0,e.startTime=1*new Date,e.stopPlay()},i=function(t){t.preventDefault(),e.offsetX=t.touches[0].pageX-e.startX;var n=e.index-1,i=n+3;for(n;i>n;n++)e.lists[n]&&e.Transform3d(e.lists[n],(n-e.index)*e.wrapWidth+e.offsetX,!1)},r=function(){var n=1*new Date;if(n-e.startTime>700)if(e.offsetX>=t)e.move("-1");else if(e.offsetX<-t)e.move("+1");else e.move("0");else if(e.offsetX>=60)e.move("-1");else if(e.offsetX<-60)e.move("+1");else e.move("0");e.autoPlay()};e.wrap.addEventListener("touchstart",n,!1),e.wrap.addEventListener("touchmove",i,!1),e.wrap.addEventListener("touchend",r,!1)},t});